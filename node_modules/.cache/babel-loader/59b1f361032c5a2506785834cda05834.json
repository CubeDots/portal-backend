{"ast":null,"code":"import _objectSpread from\"/var/www/html/cuengine-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/var/www/html/cuengine-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import Spinner from'react-bootstrap/Spinner';import{useSignIn,useIsAuthenticated,useAuthHeader}from'react-auth-kit';import Modal from'react-bootstrap/Modal';import{API_ENDPOINT}from\"../common/Constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function UpdatePasswordModal(props){var publicPath=process.env.PUBLIC_URL;var authHeader=useAuthHeader();var isAuthenticated=useIsAuthenticated();var navigate=useNavigate();var signIn=useSignIn();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),show=_React$useState2[0],setShow=_React$useState2[1];var handleClose=function handleClose(){setShow(false);};var handleShow=function handleShow(){return setShow(true);};var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),loading=_React$useState4[0],setLoading=_React$useState4[1];var _React$useState5=React.useState({old_password:'',password:'',password_confirmation:''}),_React$useState6=_slicedToArray(_React$useState5,2),formData=_React$useState6[0],setFormData=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),formErrors=_React$useState8[0],setFormErrors=_React$useState8[1];var _React$useState9=React.useState({}),_React$useState10=_slicedToArray(_React$useState9,2),formValidationErrors=_React$useState10[0],setFormValidationErrors=_React$useState10[1];// if (isAuthenticated()) {\n//     // Redirect to dashboard\n//     console.log(\"valid Redirect to dashboard\");\n//     return (\n//         <Navigate to=\"/dash\" replace />\n//     );\n// }\nuseEffect(function(){if(props.isForgotPasswordModalShow){handleShow();}if(!show){props.handleChane();}},[props,show]);var onSubmit=function onSubmit(e){e.preventDefault();setLoading(true);axios.post(API_ENDPOINT+\"auth/updatePassword\",formData,{headers:{Authorization:authHeader()}}).then(function(res){console.log('login res',res.status,res.data);if(res.status===200){setLoading(false);setFormErrors(res.data.message);setFormData(function(fd){return _objectSpread(_objectSpread({},fd),{},{old_password:'',password:'',password_confirmation:''});});setTimeout(function(){setFormErrors('');handleClose();},5000);}}).catch(function(error){setLoading(false);console.log(\"errors ### \",error.response);if(error.response.status===422){console.log(\"errors data \",error.response.data.errors);//let errorm = error.response.data.errors[0];\nconsole.log(\"error \\n\",error.response.data.message);setFormValidationErrors(error.response.data.errors);setFormErrors(error.response.data.message);setTimeout(function(){setFormValidationErrors({});setFormErrors('');},5000);}});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,className:\"forgot-password\",backdrop:\"static\",keyboard:false,centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Update Password\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-3\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Type and confirm a secure new password for the account\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[formErrors?/*#__PURE__*/_jsx(\"div\",{children:formErrors}):'',/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled\",children:formValidationErrors&&Object.keys(formValidationErrors).map(function(error,index){return/*#__PURE__*/_jsx(\"li\",{className:\"text-danger\",children:formValidationErrors[error][0]},index);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"old_password\",placeholder:\"Old Password\",value:formData.old_password,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{old_password:e.target.value}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",placeholder:\"New Password\",value:formData.password,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{password:e.target.value}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password_confirmation\",placeholder:\"Confirm Password\",value:formData.password_confirmation,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{password_confirmation:e.target.value}));}})}),loading?/*#__PURE__*/_jsxs(\"button\",{className:\"changePassword\",type:\"button\",disabled:true,children:[/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"  Submitting...\"]}):/*#__PURE__*/_jsx(\"button\",{className:\" changePassword \",type:\"submit\",children:\"Submit\"})]})]})})]})});}export default UpdatePasswordModal;","map":{"version":3,"sources":["/var/www/html/cuengine-portal/src/components/UpdatePasswordModal.js"],"names":["React","useEffect","useNavigate","axios","Spinner","useSignIn","useIsAuthenticated","useAuthHeader","Modal","API_ENDPOINT","UpdatePasswordModal","props","publicPath","process","env","PUBLIC_URL","authHeader","isAuthenticated","navigate","signIn","useState","show","setShow","handleClose","handleShow","loading","setLoading","old_password","password","password_confirmation","formData","setFormData","formErrors","setFormErrors","formValidationErrors","setFormValidationErrors","isForgotPasswordModalShow","handleChane","onSubmit","e","preventDefault","post","headers","Authorization","then","res","console","log","status","data","message","fd","setTimeout","catch","error","response","errors","Object","keys","map","index","target","value"],"mappings":"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","sourcesContent":["\nimport React, { useEffect } from 'react';\nimport { useNavigate} from 'react-router-dom';\nimport axios from 'axios';\nimport Spinner from 'react-bootstrap/Spinner';\nimport { useSignIn, useIsAuthenticated, useAuthHeader } from 'react-auth-kit';\nimport Modal from 'react-bootstrap/Modal';\n\nimport { API_ENDPOINT } from \"../common/Constants\";\n\nfunction UpdatePasswordModal(props) {\n    let publicPath = process.env.PUBLIC_URL;\n    const authHeader = useAuthHeader();\n    const isAuthenticated = useIsAuthenticated();\n    const navigate = useNavigate();\n    const signIn = useSignIn();\n\n    const [show, setShow] = React.useState(false);\n\n    const handleClose = () => { setShow(false); }\n    const handleShow = () => setShow(true);\n\n    const [loading, setLoading] = React.useState(false);\n    const [formData, setFormData] = React.useState({ old_password: '', password: '', password_confirmation: '' });\n    const [formErrors, setFormErrors] = React.useState('');\n    const [formValidationErrors, setFormValidationErrors] = React.useState({});\n\n    // if (isAuthenticated()) {\n    //     // Redirect to dashboard\n    //     console.log(\"valid Redirect to dashboard\");\n    //     return (\n    //         <Navigate to=\"/dash\" replace />\n    //     );\n    // }\n    useEffect(() => {\n        if (props.isForgotPasswordModalShow) {\n            handleShow();\n        }\n        if (!show) {\n            props.handleChane();\n        }\n    }, [props, show])\n\n    const onSubmit = (e) => {\n        e.preventDefault()\n        setLoading(true);\n        axios.post(API_ENDPOINT + \"auth/updatePassword\", formData, { headers: { Authorization: authHeader() } })\n            .then((res) => {\n                console.log('login res', res.status, res.data)\n                if (res.status === 200) {\n                    setLoading(false);\n                    setFormErrors(res.data.message);\n                    setFormData(fd => ({ ...fd, old_password: '', password: '', password_confirmation: '' }));\n                    setTimeout(() => {\n                        setFormErrors('');\n                        handleClose();\n                        \n                    }, 5000);\n                }\n            }).catch((error) => {\n                setLoading(false);\n                console.log(\"errors ### \", error.response);\n                if (error.response.status === 422) {\n                    console.log(\"errors data \", error.response.data.errors);\n                    //let errorm = error.response.data.errors[0];\n                    console.log(\"error \\n\", error.response.data.message)\n                    setFormValidationErrors(error.response.data.errors);\n                    setFormErrors(error.response.data.message);\n                    setTimeout(() => {\n                        setFormValidationErrors({});\n                        setFormErrors('');\n                    }, 5000);\n                }\n            })\n    }\n\n\n    return (\n        <>\n            <Modal show={show} onHide={handleClose} className=\"forgot-password\" backdrop=\"static\" keyboard={false} centered>\n                <Modal.Header closeButton>\n                <Modal.Title>Update Password</Modal.Title>\n                </Modal.Header>\n                <div className='modal-body'>\n                    <div className='px-3'>\n                        <p>Type and confirm a secure new password for the account</p>\n                        <form onSubmit={onSubmit}>\n                            <div className=\"mb-3\">\n\n                                {formErrors ?\n                                    <div>{formErrors}</div>\n                                    : ''}\n                                <ul className=\"list-unstyled\">\n                                    {formValidationErrors && Object.keys(formValidationErrors).map((error, index) => (\n                                        <li className=\"text-danger\" key={index}>{formValidationErrors[error][0]}</li>\n                                    ))}\n                                </ul>\n                            </div>\n                            <div className=\"mb-3\">\n                                <input type=\"password\" className=\"form-control\" name=\"old_password\" placeholder='Old Password' value={formData.old_password} onChange={(e) => setFormData({ ...formData, old_password: e.target.value })} />\n                            </div>\n                            <div className=\"mb-3\">\n                                <input type=\"password\" className=\"form-control\" name=\"password\" placeholder='New Password' value={formData.password} onChange={(e) => setFormData({ ...formData, password: e.target.value })} />\n                            </div>\n                            <div className=\"mb-3\">\n                                <input type=\"password\" className=\"form-control\" name=\"password_confirmation\" placeholder='Confirm Password' value={formData.password_confirmation} onChange={(e) => setFormData({ ...formData, password_confirmation: e.target.value })} />\n                            </div>\n\n                            {loading ?\n                                <button className=\"changePassword\" type=\"button\" disabled >\n                                    <Spinner as=\"span\" animation=\"border\" size=\"sm\" role=\"status\" aria-hidden=\"true\" />  Submitting...\n                                </button>\n                                :\n                                <button className=\" changePassword \" type=\"submit\">Submit</button>\n                            }\n\n                        </form>\n                    </div>\n                </div>\n\n            </Modal>\n        </>\n    );\n}\n\nexport default UpdatePasswordModal;"]},"metadata":{},"sourceType":"module"}