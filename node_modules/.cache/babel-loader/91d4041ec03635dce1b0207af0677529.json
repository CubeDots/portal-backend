{"ast":null,"code":"import _objectSpread from\"/var/www/html/cuengine-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/var/www/html/cuengine-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import{useNavigate,useLocation,Link}from'react-router-dom';import axios from'axios';import Spinner from'react-bootstrap/Spinner';import{useSignIn,useIsAuthenticated}from'react-auth-kit';import Modal from'react-bootstrap/Modal';import{LazyLoadImage}from'react-lazy-load-image-component';import'react-lazy-load-image-component/src/effects/blur.css';import BecomeOurPartnerModal from\"./home/BecomeOurPartnerModal\";import{API_ENDPOINT}from'../common/Constants';import ForgotPasswordModal from'./ForgotPasswordModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function LoginModal(props){var publicPath=process.env.PUBLIC_URL;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isBecomeOurPartnerModalShow=_useState2[0],setIsBecomeOurPartnerModalShow=_useState2[1];var isAuthenticated=useIsAuthenticated();var navigate=useNavigate();var location=useLocation();var signIn=useSignIn();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),show=_useState4[0],setShow=_useState4[1];var handleClose=function handleClose(){setShow(false);};var handleShow=function handleShow(){return setShow(true);};var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState({email:'',password:'',rememberMe:false}),_useState8=_slicedToArray(_useState7,2),formData=_useState8[0],setFormData=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),formErrors=_useState10[0],setFormErrors=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),formValidationErrors=_useState12[0],setFormValidationErrors=_useState12[1];//forgot password\nvar _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isForgotPasswordModalShow=_useState14[0],setisForgotPasswordModalShow=_useState14[1];var showBecomeOurPartnerModal=function showBecomeOurPartnerModal(){console.log(\"showBecomeOurPartnerModal clicked\");handleClose();setTimeout(function(){setIsBecomeOurPartnerModalShow(true);},300);};var closeBecomeOurPartnerModalModal=function closeBecomeOurPartnerModalModal(){console.log(\"closeBecomeOurPartnerModalModal trigger\");setIsBecomeOurPartnerModalShow(false);};var openForgotPasswordModal=function openForgotPasswordModal(){console.log('openForgotPasswordModal click manually');handleClose();setTimeout(function(){setisForgotPasswordModalShow(true);},300);};var closeForgotPasswordModal=function closeForgotPasswordModal(){console.log('closeForgotPasswordModal trigger');setisForgotPasswordModalShow(false);// handleShow();\nsetTimeout(function(){handleShow();},300);};// if (isAuthenticated()) {\n//     // Redirect to dashboard\n//     console.log(\"valid Redirect to dashboard\");\n//     return (\n//         <Navigate to=\"/dash\" replace />\n//     );\n// }\nvar getLoginData=function getLoginData(){return sessionStorage.getItem(\"loginData\")||null;};var setLoginData=function setLoginData(value){if(value)sessionStorage.setItem(\"loginData\",value);else sessionStorage.removeItem(\"loginData\");};useEffect(function(){},[]);useEffect(function(){if(props.isLoginModalShow){handleShow();}if(!show){props.handleChane();}console.log(\"location #### \",location.pathname);},[props,show]);var onSubmit=function onSubmit(e){e.preventDefault();setLoading(true);if(formData.rememberMe){setLoginData(formData);}else{setLoginData(null);}axios.post(API_ENDPOINT+'auth',formData).then(function(res){console.log('login res',res.status,res.data);if(res.status===200){setLoading(false);if(signIn({token:res.data.data.token,expiresIn:res.data.data.expires_at,tokenType:\"Bearer\",authState:{user:res.data.data.user}//    refreshToken: res.data.refreshToken, // Only if you are using refreshToken feature\n//    refreshTokenExpireIn: res.data.refreshTokenExpireIn\n})){// Only if you are using refreshToken feature\n// Redirect or do-something\nhandleClose();console.log(\"location.pathname \",location.pathname);// if (location.pathname === '/')\n//     navigate(\"/dash\");\n// else\nnavigate(location.pathname);}else{//Throw error\n//alert(\"Errors \\n\"+res.errors[0])\n}}}).catch(function(error){setLoading(false);console.log(\"errors ### \",error.response);if(error.response.status===422){console.log(\"errors data \",error.response.data.errors);//let errorm = error.response.data.errors[0];\nconsole.log(\"error \\n\",error.response.data.message);setFormValidationErrors(error.response.data.errors);setFormErrors(error.response.data.message);setTimeout(function(){setFormValidationErrors({});setFormErrors('');},5000);}});};var handleCheckbox=function handleCheckbox(e){setFormData(function(formData){return _objectSpread(_objectSpread({},formData),{},{rememberMe:e.target.value});});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BecomeOurPartnerModal,{show:isBecomeOurPartnerModalShow,onHide:closeBecomeOurPartnerModalModal}),/*#__PURE__*/_jsx(Modal,{show:show,onHide:handleClose,className:\"SignIn\",centered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"signInBox\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signinImg\",children:/*#__PURE__*/_jsx(LazyLoadImage,{effect:\"blur\"// src={publicPath + \"/assets/images/2.webp\"} \n,src:publicPath+\"/assets/images/loginpage/loginbanner.jpg\",className:\"img-fluid w-100\",alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"SignInFrom\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sign In\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Welcome back to Cubedots \\u2013 Cubedots\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled\",children:formValidationErrors&&Object.keys(formValidationErrors).map(function(error,index){return/*#__PURE__*/_jsx(\"li\",{className:\"text-danger\",children:formValidationErrors[error][0]},index);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",name:\"email\",placeholder:\"Email Address\",onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",placeholder:\"Password\",onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{password:e.target.value}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"form-check-input\",id:\"rememberMe\",name:\"checkbox\",checked:formData.rememberMe,onChange:function onChange(event){return handleCheckbox(event);}// required\n}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"rememberMe\",children:\"Remember me\"})]})}),loading?/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-primary\",type:\"button\",disabled:true,children:[/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"  Submitting...\"]}):/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"my-3 text-center\",children:/*#__PURE__*/_jsx(Link,{to:\"\",className:\"form-check-label\",onClick:openForgotPasswordModal,children:\"Forgot your password?\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3 text-center\",children:[\"Not yet a member of Cubedots - Cubedots?\",/*#__PURE__*/_jsx(\"br\",{}),\" \",/*#__PURE__*/_jsx(Link,{to:\"\",className:\"form-check-label\",onClick:showBecomeOurPartnerModal,children:\"Become Our Partner\"})]})]})]})]})]})}),isForgotPasswordModalShow?/*#__PURE__*/_jsx(ForgotPasswordModal,{handleChanel:closeForgotPasswordModal}):'']});}export default LoginModal;","map":{"version":3,"sources":["/var/www/html/cuengine-portal/src/components/LoginModal.js"],"names":["useEffect","useState","useNavigate","useLocation","Link","axios","Spinner","useSignIn","useIsAuthenticated","Modal","LazyLoadImage","BecomeOurPartnerModal","API_ENDPOINT","ForgotPasswordModal","LoginModal","props","publicPath","process","env","PUBLIC_URL","isBecomeOurPartnerModalShow","setIsBecomeOurPartnerModalShow","isAuthenticated","navigate","location","signIn","show","setShow","handleClose","handleShow","loading","setLoading","email","password","rememberMe","formData","setFormData","formErrors","setFormErrors","formValidationErrors","setFormValidationErrors","isForgotPasswordModalShow","setisForgotPasswordModalShow","showBecomeOurPartnerModal","console","log","setTimeout","closeBecomeOurPartnerModalModal","openForgotPasswordModal","closeForgotPasswordModal","getLoginData","sessionStorage","getItem","setLoginData","value","setItem","removeItem","isLoginModalShow","handleChane","pathname","onSubmit","e","preventDefault","post","then","res","status","data","token","expiresIn","expires_at","tokenType","authState","user","catch","error","response","errors","message","handleCheckbox","target","Object","keys","map","index","event"],"mappings":"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","sourcesContent":["\nimport { useEffect,useState } from 'react';\nimport { useNavigate, useLocation, Link } from 'react-router-dom';\nimport axios from 'axios';\nimport Spinner from 'react-bootstrap/Spinner';\nimport { useSignIn, useIsAuthenticated } from 'react-auth-kit';\nimport Modal from 'react-bootstrap/Modal';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport 'react-lazy-load-image-component/src/effects/blur.css';\nimport BecomeOurPartnerModal from \"./home/BecomeOurPartnerModal\";\n\nimport { API_ENDPOINT } from '../common/Constants';\n\nimport ForgotPasswordModal from './ForgotPasswordModal';\n\n\n\nfunction LoginModal(props) {\n    let publicPath = process.env.PUBLIC_URL;\n\n    const [isBecomeOurPartnerModalShow, setIsBecomeOurPartnerModalShow] = useState(false);\n  \n  \n    const isAuthenticated = useIsAuthenticated();\n    const navigate = useNavigate();\n    const location = useLocation();\n    const signIn = useSignIn();\n\n    const [show, setShow] = useState(false);\n    const handleClose = () => { setShow(false); }\n    const handleShow = () => setShow(true);\n\n    const [loading, setLoading] = useState(false);\n    const [formData, setFormData] = useState({ email: '', password: '', rememberMe: false });\n    const [formErrors, setFormErrors] = useState('');\n    const [formValidationErrors, setFormValidationErrors] = useState({});\n\n    //forgot password\n\n    const [isForgotPasswordModalShow, setisForgotPasswordModalShow] = useState(false);\n\n    const showBecomeOurPartnerModal = () => {\n        console.log(\"showBecomeOurPartnerModal clicked\");\n        handleClose();\n        setTimeout(() => {\n            setIsBecomeOurPartnerModalShow(true);\n        }, 300);\n\n        \n      }\n    \n      const closeBecomeOurPartnerModalModal = () => {\n        console.log(\"closeBecomeOurPartnerModalModal trigger\");\n        setIsBecomeOurPartnerModalShow(false);\n      }\n\n    const openForgotPasswordModal = () => {\n        console.log('openForgotPasswordModal click manually');\n        handleClose();\n        setTimeout(() => {\n            setisForgotPasswordModalShow(true);\n        }, 300);\n\n    };\n    const closeForgotPasswordModal = () => {\n        console.log('closeForgotPasswordModal trigger');\n        setisForgotPasswordModalShow(false);\n        // handleShow();\n        setTimeout(() => {\n            handleShow();\n        }, 300);\n    };\n\n\n    // if (isAuthenticated()) {\n    //     // Redirect to dashboard\n    //     console.log(\"valid Redirect to dashboard\");\n    //     return (\n    //         <Navigate to=\"/dash\" replace />\n    //     );\n    // }\n\n    const getLoginData = () => {\n        return sessionStorage.getItem(\"loginData\") || null;\n    };\n\n    const setLoginData = (value) => {\n        if(value)\n        sessionStorage.setItem(\"loginData\", value);\n        else\n        sessionStorage.removeItem(\"loginData\");\n    };\n\n    useEffect(() => {\n\n    }, []);\n    useEffect(() => {\n        if (props.isLoginModalShow) {\n            handleShow();\n        }\n        if (!show) {\n            props.handleChane();\n        }\n\n        console.log(\"location #### \", location.pathname);\n    }, [props, show])\n\n    const onSubmit = (e) => {\n        e.preventDefault()\n        setLoading(true);\n        if(formData.rememberMe){\n            setLoginData(formData);\n        }else{\n            setLoginData(null);\n        }\n        axios.post(API_ENDPOINT + 'auth', formData)\n            .then((res) => {\n                console.log('login res', res.status, res.data)\n                if (res.status === 200) {\n                    setLoading(false);\n                    if (signIn({\n                        token: res.data.data.token,\n                        expiresIn: res.data.data.expires_at,\n                        tokenType: \"Bearer\",\n                        authState: { user: res.data.data.user },\n                        //    refreshToken: res.data.refreshToken, // Only if you are using refreshToken feature\n                        //    refreshTokenExpireIn: res.data.refreshTokenExpireIn\n                    })) { // Only if you are using refreshToken feature\n                        // Redirect or do-something\n                        handleClose();\n                        console.log(\"location.pathname \", location.pathname);\n                        // if (location.pathname === '/')\n                        //     navigate(\"/dash\");\n                        // else\n                            navigate(location.pathname);\n\n                    } else {\n                        //Throw error\n                        //alert(\"Errors \\n\"+res.errors[0])\n\n                    }\n                }\n            }).catch((error) => {\n                setLoading(false);\n                console.log(\"errors ### \", error.response);\n                if (error.response.status === 422) {\n                    console.log(\"errors data \", error.response.data.errors);\n                    //let errorm = error.response.data.errors[0];\n                    console.log(\"error \\n\", error.response.data.message)\n                    setFormValidationErrors(error.response.data.errors);\n                    setFormErrors(error.response.data.message);\n                    setTimeout(() => {\n                        setFormValidationErrors({});\n                        setFormErrors('');\n                    }, 5000);\n                }\n            })\n    }\n\n\n    const handleCheckbox = (e) => {\n        setFormData(formData => ({ ...formData, rememberMe: e.target.value }));\n    }\n\n    return (\n        <>\n            <BecomeOurPartnerModal show={isBecomeOurPartnerModalShow} onHide={closeBecomeOurPartnerModalModal} />\n            <Modal show={show} onHide={handleClose} className=\"SignIn\" centered>\n\n                {/* <div className=\"modal fade SignIn\" id=\"SignIn\" tabIndex=\"-1\" aria-labelledby=\"SignInLabel\" aria-hidden=\"true\"> */}\n                {/* <div className=\"modal-dialog modal-dialog-centered\">\n                    <div className=\"modal-content\"> */}\n                <div className=\"signInBox\">\n                    <Modal.Header closeButton>\n                    </Modal.Header>\n                    <div className=\"modal-body\">\n                        <div className='signinImg'>\n                            <LazyLoadImage\n                                effect=\"blur\"\n                                // src={publicPath + \"/assets/images/2.webp\"} \n                                src={publicPath + \"/assets/images/loginpage/loginbanner.jpg\"}\n\n                                className=\"img-fluid w-100\"\n                                alt=\"\" />\n                            {/* <img src={publicPath + \"/assets/images/2.webp\"} className='img-fluid' alt='' /> */}\n                        </div>\n                        <div className='SignInFrom'>\n                            <h2>Sign In</h2>\n                            <p>Welcome back to Cubedots – Cubedots</p>\n                            <form onSubmit={onSubmit}>\n                                <div className=\"mb-3\">\n                                    {/* {loading ? 'loading...' : ''} */}\n                                    {/* {formErrors} */}\n                                    <ul className=\"list-unstyled\">\n                                        {formValidationErrors && Object.keys(formValidationErrors).map((error, index) => (\n                                            <li className=\"text-danger\" key={index}>{formValidationErrors[error][0]}</li>\n                                        ))}\n                                    </ul>\n                                </div>\n                                <div className=\"mb-3\">\n                                    <input type=\"email\" className=\"form-control\" name=\"email\" placeholder=\"Email Address\" onChange={(e) => setFormData({ ...formData, email: e.target.value })} />\n                                </div>\n                                <div className=\"mb-3\">\n                                    <input type=\"password\" className=\"form-control\" name=\"password\" placeholder='Password' onChange={(e) => setFormData({ ...formData, password: e.target.value })} />\n                                </div>\n\n                                <div className=\"mb-3\">\n\n                                    <div className=\"form-check\">\n                                        <input\n                                            type=\"checkbox\"\n                                            className=\"form-check-input\"\n                                            id=\"rememberMe\"\n                                            name=\"checkbox\"\n                                            checked={formData.rememberMe}\n                                            onChange={(event) => handleCheckbox(event)}\n                                        // required\n                                        />\n                                        <label className=\"form-check-label\" htmlFor=\"rememberMe\">\n                                            Remember me\n                                        </label>\n                                    </div>\n                                </div>\n\n                                {loading ?\n                                    <button className=\"btn btn-primary\" type=\"button\" disabled >\n                                        <Spinner as=\"span\" animation=\"border\" size=\"sm\" role=\"status\" aria-hidden=\"true\" />  Submitting...\n                                    </button>\n                                    :\n                                    <button className=\"btn btn-primary\" type=\"submit\">Login</button>\n                                }\n\n \n                                <div className=\"my-3 text-center\">\n                                    <Link to=\"\" className=\"form-check-label\" onClick={openForgotPasswordModal}>Forgot your password?</Link>\n                                </div>\n                               \n                                <div className=\"my-3 text-center\">\n                                Not yet a member of Cubedots - Cubedots?<br /> <Link to=\"\" className=\"form-check-label\" onClick={showBecomeOurPartnerModal}>Become Our Partner</Link>\n                                </div>\n                            </form>\n\n                        </div>\n\n                    </div>\n                    {/* </div>\n                </div> */}\n                    {/* </div> */}\n                </div>\n\n            </Modal>\n            {isForgotPasswordModalShow ? (\n                <ForgotPasswordModal handleChanel={closeForgotPasswordModal} />\n            ) : ''}\n\n        </>\n    );\n}\n\nexport default LoginModal;"]},"metadata":{},"sourceType":"module"}